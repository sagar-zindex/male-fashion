<!-- Product Section Begin -->
{% if section.blocks.size > 0 %}
  <section class="product spad">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <ul class="filter__controls">
            {% for block in section.blocks %}
              {% if block.type == 'collection_tab' %}
                {% if block.settings.tab_title != blank %}
                  <li class="{% if forloop.first %}active{% endif %}" data-filter=".tab_{{ block.id }}">
                    {{ block.settings.tab_title }}
                  </li>
                {% else %}
                  <li class="{% if forloop.first %}active{% endif %}" data-filter=".tab_{{ block.id }}">
                    {{ block.settings.collection.title }}
                  </li>
                {% endif %}
              {% endif %}
            {% endfor %}
          </ul>
        </div>
      </div>
      <div class="row product__filter">
        {% for block in section.blocks %}
          {% if block.settings.collection != blank %}
            {% for product in block.settings.collection.products limit: section.settings.products_limit %}
              <div
                class="col-lg-3 col-md-6 col-sm-6 col-md-6 col-sm-6 mix tab_{{ block.id }}"
                {{ block.shopify_attributes }}
              >
                <div class="product__item">
                  <div
                    class="product__item__pic set-bg"
                    data-setbg="{{ product.featured_image | image_url: width:600 }}"
                  >
                    {% assign now = 'now' | date: '%s' %}
                    {% assign published = product.published_at | date: '%s' %}
                    {% assign days_since_published = now | minus: published | divided_by: 86400 %}

                    {% if product.compare_at_price > product.price %}
                      <span class="label">sale</span>
                    {% elsif days_since_published <= 30 %}
                      <span class="label new">New</span>
                    {% endif %}
                    <ul class="product__hover">
                      <li>
                        <a
                          href="javascript:void(0);"
                          class="froonze-wishlist-btn"
                          data-product-id="{{ product.id }}"
                          data-product-handle="{{ product.handle }}"
                          aria-label="Add to wishlist"
                        >
                          <img src="{{ 'heart.png' | asset_url }}" alt="Wishlist">
                        </a>
                      </li>
                      <li>
                        <a
                          href="#"
                          class="snap-compare-btn"
                          data-product-id="{{ product.id }}"
                          aria-label="Compare product"
                        >
                          <img src="{{ 'compare.png' | asset_url }}" alt="">
                          <span>Compare</span>
                        </a>
                        <li><a href="{{ product.url }}">View</a></li>
                      </li>
                    </ul>
                  </div>
                  <div class="product__item__text">
                    <h6>{{ product.title }}</h6>
                    <a href="#" class="add-cart-btn" data-variant-id="{{ product.variants.first.id }}">
                      + Add To Cart
                    </a>

                    <div class="rating">
                      {{ product.metafields.judgeme.badge }}
                    </div>
                    <h5>{{ product.price | money }}</h5>
                    {% assign color_index = -1 %}

                    {% for option in product.options_with_values %}
                      {% if option.name == 'Color' %}
                        {% assign color_index = forloop.index0 %}
                      {% endif %}
                    {% endfor %}

                    {% if color_index != -1 %}
                      <div class="product__color__select">
                        {% assign used_colors = '' %}
                        {% for variant in product.variants %}
                          {% assign color = variant.options[color_index] %}
                          {% unless used_colors contains color %}
                            {% assign used_colors = used_colors | append: color | append: ',' %}
                            <label
                              class="color-swatch"
                              title="{{ color }}"
                              data-variant-id="{{ variant.id }}"
                            >
                              <input
                                type="radio"
                                name="color-{{ product.id }}"
                                value="{{ variant.id }}"
                              >
                              <span style="background-color: {{ color | downcase }};"></span>
                            </label>
                          {% endunless %}
                        {% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>
              </div>
            {% endfor %}
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </section>
{% endif %}
<!-- Product Section End -->

{% schema %}
{
  "name": "Home Product",
  "settings": [
    {
      "type": "range",
      "id": "products_limit",
      "label": "Products Limit",
      "min": 4,
      "max": 12,
      "step": 1,
      "default": 8
    }
  ],
  "blocks": [
    {
      "type": "collection_tab",
      "name": "Collection Tab",
      "settings": [
        {
          "type": "text",
          "id": "tab_title",
          "label": "Tab Title",
          "default": "Best Sellers"
        },
        {
          "type": "collection",
          "id": "collection",
          "label": "Select Collection"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Home Product"
    }
  ]
}
{% endschema %}
